/*
 * Webim v1.0.0pre
 * http://www.nextim.cn/
 *
 * Copyright (c) 2009 Hidden
 *
 * Date: 
 * Revision: 
 */
(function(I,d,m){function J(){return(new Date).getTime()}var y=Object.prototype.toString;function q(R){return y.call(R)==="[object Function]"}function c(){var S=s("tid");if(S==""){var R=new RegExp("/thread-([^-])-","i");if(R.test(location.href)){S=RegExp.$1}}return S}function s(S){var R=new RegExp("(^|\\?|&)"+S+"=([^&]*)(\\s|&|$)","i");if(R.test(location.href)){return unescape(RegExp.$2.replace(/\+/g," "))}return""}function v(R){return y.call(R)==="[object Array]"}function E(R){return R&&y.call(R)==="[object Object]"}function a(R){return(R||"").replace(/^\s+|\s+$/g,"")}function Q(R,U){var T=false;if(E(U)){R=R||{};for(var S in U){var V=U[S];if(R[S]!=V){T=T||{};T[S]=V}}}return T}function p(T){var R=[];if(T!=null){var S=T.length;if(S==null||typeof T==="string"||q(T)||T.setInterval){R[0]=T}else{while(S){R[--S]=T[S]}}}return R}function k(){var W=arguments[0]||{},U=1,V=arguments.length,R=false,T;if(typeof W==="boolean"){R=W;W=arguments[1]||{};U=2}if(typeof W!=="object"&&!q(W)){W={}}for(;U<V;U++){if((T=arguments[U])!=null){for(var S in T){var X=W[S],Y=T[S];if(W===Y){continue}if(R&&Y&&typeof Y==="object"&&!Y.nodeType){W[S]=k(R,X||(Y.length!=null?[]:{}),Y)}else{if(Y!==m){W[S]=Y}}}}}return W}function K(U,Y,T){var S,V=0,W=U.length,R=W===m||q(U);if(T){if(R){for(S in U){if(Y.apply(U[S],T)===false){break}}}else{for(;V<W;){if(Y.apply(U[V++],T)===false){break}}}}else{if(R){for(S in U){if(Y.call(U[S],S,U[S])===false){break}}}else{for(var X=U[0];V<W&&Y.call(X,V,X)!==false;X=U[++V]){}}}return U}function L(T,U){for(var R=0,S=U.length;R<S;R++){if(U[R]===T){return R}}return -1}function N(S,W,R){var T=[];for(var U=0,V=S.length;U<V;U++){if(!R!==!W(S[U],U)){T.push(S[U])}}return T}function w(R,W){var S=[],V;for(var T=0,U=R.length;T<U;T++){V=W(R[T],T);if(V!=null){S[S.length]=V}}return S.concat.apply([],S)}var t={option:function(T,U){var S=T,R=this;R.options=R.options||{};if(typeof T=="string"){if(U===m){return R.options[T]}S={};S[T]=U}k(R.options,S);return R},bind:function(T,S){var R=this,U=R._events=R._events||{};if(q(S)){U[T]=U[T]||[];U[T].push(S)}return this},trigger:function(W,T){var S=this,X=S._events=S._events||{},V=X[W];if(!V){return this}T=v(T)?T:p(T);for(var U=0,R=V.length;U<R;U++){V[U].apply(this,T)}return this},unbind:function(V,U){var S=this,W=S._events=S._events||{};if(!W[V]){return this}if(q(U)){var R=W[V];for(var T=R.length;T--;T){if(R[T]===U||R[T]===U._proxy){R.splice(T,1)}}}else{delete W[V]}return this},one:function(U,T){if(!q(T)){return this}var R=this,S=T._proxy=fun._proxy||function(){R.unbind(U,S);return T.apply(this,arguments)};R.bind(U,S)}};function h(R){var T=[];if(typeof R=="object"){for(var S in R){T[T.length]=encodeURIComponent(S)+"="+encodeURIComponent(R[S])}return T.join("&").replace(P,"+")}return R}var f=J(),H=/\?/,F=/(\?|&)_=.*?(&|$)/,P=/%20/g,j={url:location.href,global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,xhr:function(){return I.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest()},accepts:{xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"}},D={},o={};function M(S,U,R,T){if(S.error){S.error.call(S.context||I,U,R,T)}}function r(S){try{return !S.status&&location.protocol==="file:"||(S.status>=200&&S.status<300)||S.status===304||S.status===1223||S.status===0}catch(R){}return false}function n(U,S){var T=U.getResponseHeader("Last-Modified"),R=U.getResponseHeader("Etag");if(T){D[S]=T}if(R){o[S]=R}return U.status===304||U.status===0}function u(W,U,T){var S=W.getResponseHeader("content-type"),R=U==="xml"||!U&&S&&S.indexOf("xml")>=0,V=R?W.responseXML:W.responseText;if(R&&V.documentElement.nodeName==="parsererror"){throw"parsererror"}if(T&&T.dataFilter){V=T.dataFilter(V,U)}if(typeof V==="string"){if(U==="json"){if(typeof g==="object"&&g.parse){V=g.parse(V)}else{V=(new Function("return "+V))()}}}return V}function G(R){k(j,R)}function A(ae){ae=k(true,ae,k(true,{},j,ae));var U,V,T=ae.context||I,Z=ae.type.toUpperCase();if(ae.data&&ae.processData&&typeof ae.data!=="string"){ae.data=h(ae.data)}if(ae.cache===false&&Z==="GET"){var Y=J();var X=ae.url.replace(F,"$1_="+Y+"$2");ae.url=X+((X===ae.url)?(H.test(ae.url)?"&":"?")+"_="+Y:"")}if(ae.data&&Z==="GET"){ae.url+=(H.test(ae.url)?"&":"?")+ae.data}var S=false;var ad=ae.xhr();if(ae.username){ad.open(Z,ae.url,ae.async,ae.username,ae.password)}else{ad.open(Z,ae.url,ae.async)}try{if(ae.data){ad.setRequestHeader("Content-Type",ae.contentType)}if(ae.ifModified){if(D[ae.url]){ad.setRequestHeader("If-Modified-Since",D[ae.url])}if(o[ae.url]){ad.setRequestHeader("If-None-Match",o[ae.url])}}ad.setRequestHeader("X-Requested-With","XMLHttpRequest");ad.setRequestHeader("Accept",ae.dataType&&ae.accepts[ae.dataType]?ae.accepts[ae.dataType]+", */*":ae.accepts._default)}catch(W){}if(ae.beforeSend&&ae.beforeSend.call(T,ad,ae)===false){ad.abort();return false}var ab=function(af){if(!ad||ad.readyState===0){if(aa){clearInterval(aa);aa=null}}else{if(!S&&ad&&(ad.readyState===4||af==="timeout")){S=true;if(aa){clearInterval(aa);aa=null}U=af==="timeout"?"timeout":!r(ad)?"error":ae.ifModified&&n(ad,ae.url)?"notmodified":"success";if(U==="success"){try{V=u(ad,ae.dataType,ae)}catch(ag){U="parsererror"}}if(U==="success"||U==="notmodified"){ac()}else{M(ae,ad,U)}R();if(af){ad.abort()}if(ae.async){ad=null}}}};if(ae.async){var aa=setInterval(ab,13);if(ae.timeout>0){setTimeout(function(){if(ad&&!S){ab("timeout")}},ae.timeout)}}try{ad.send(Z==="POST"||Z==="PUT"?ae.data:null)}catch(W){M(ae,ad,null,W)}if(!ae.async){ab()}function ac(){if(ae.success){ae.success.call(T,V,U)}}function R(){if(ae.complete){ae.complete.call(T,ad,U)}}return ad}function z(){}function l(Z){Z=k({},Z);var T=""+h(Z.data),R=Z.context||I,X="jsonp"+f++,V=d.getElementsByTagName("head")[0]||d.documentElement,W=d.createElement("script");T=(T?(T+"&"):"")+(Z.jsonp||"callback")+"="+X;Z.url+=(H.test(Z.url)?"&":"?")+T;W.src=Z.url;if(Z.scriptCharset){W.charset=Z.scriptCharset}var S=false;I[X]=function(aa){Z.success&&Z.success.call(R,aa,"success");Y()};W.onload=W.onreadystatechange=function(){if(!S&&(!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){U("error");Y()}};if(Z.timeout>0){setTimeout(function(){if(!S){U("timeout");Y();I[X]=z}},Z.timeout)}V.insertBefore(W,V.firstChild);return m;function Y(){S=true;I[X]=m;try{delete I[X]}catch(aa){}W.onload=W.onreadystatechange=null;if(V&&W.parentNode){V.removeChild(W)}}function U(aa){Z.error&&Z.error.call(R,aa)}}var g=(function(){var S={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function T(U){return S[U]||"\\u00"+Math.floor(U.charCodeAt()/16).toString(16)+(U.charCodeAt()%16).toString(16)}function R(Z){switch(Object.prototype.toString.call(Z)){case"[object String]":return'"'+Z.replace(/[\x00-\x1f\\"]/g,T)+'"';case"[object Array]":var V=[],U=Z.length;for(var Y=0;Y<U;Y++){V.push(R(Z[Y]))}return"["+V.join(",")+"]";case"[object Object]":var V=[];for(var X in Z){var W=R(Z[X]);if(W){V.push(R(X)+":"+W)}}return"{"+V+"}";case"[object Number]":case"[object Boolean]":return String(Z);case false:return"null"}return null}return{encode:R,decode:function(U){if(!U||!U.length){return null}return(new Function("return "+U))()}}})();function B(T,S){var R=this;R._setting();R.options={jsonp:false,host:null,port:null,server:null,ticket:null,domain:null,url:{send:null}};k(R.options,S)}k(B.prototype,t,{_setting:function(){var R=this;R.connected=false;R._connecting=false;R._onPolling=false;R._pollTimer=null;R._pollingTimes=0;R._failTimes=0},connect:function(T){var R=this;k(R.options,T);if(R._connecting){return R}R._connecting=true;var T=R.options,S=false,U=[];K(["server","ticket","domain"],function(W,V){if(!T[V]){U.push(V);U.push(" required.");S=true}});if(S){R._onError("error",U.join(" "));return R}if(!R._onPolling){I.setTimeout(function(){R._startPolling()},300)}return R},close:function(){var R=this;if(R._pollTimer){clearTimeout(R._pollTimer)}R._setting();return R},_onConnect:function(){var R=this;R.connected=true;R.trigger("connect","success")},_onClose:function(R){var S=this;S._setting();S.trigger("close",[R])},_onData:function(S){var R=this;R.trigger("data",S)},_onError:function(S){var R=this;R._setting();R.trigger("error",S)},_startPolling:function(){var R=this,T=R.options;R._onPolling=true;R._pollingTimes++;var S=T.server+"/packets";var U={domain:T.domain,ticket:T.ticket};var V={url:S,data:U,timeout:40000,cache:false,context:R,success:R._onPollSuccess,error:R._onPollError};if(T.jsonp){k(V,{timeout:40000,dataType:"jsonp",jsonp:"callback"});l(V)}else{A(V)}},_onPollSuccess:function(S){var R=this;R._onPolling=false;if(!R._connecting){return}if(R._pollingTimes==1){R._onConnect()}R._onData(S);R._failTimes=0;R._pollTimer=I.setTimeout(function(){R._startPolling()},200)},_onPollError:function(R){var S=this;S._onPolling=false;if(!S._connecting){return}S._failTimes++;if(S._pollingTimes==1){S._onError("can not connect.")}else{if(S._failTimes>1){S._onClose(R)}else{S._pollTimer=I.setTimeout(function(){S._startPolling()},200)}}}});function x(S,Z,ac){if(typeof Z!="undefined"){ac=ac||{};if(Z===null){Z="";ac=k({},ac);ac.expires=-1}var V="";if(ac.expires&&(typeof ac.expires=="number"||ac.expires.toUTCString)){var W;if(typeof ac.expires=="number"){W=new Date();W.setTime(W.getTime()+(ac.expires*24*60*60*1000))}else{W=ac.expires}V="; expires="+W.toUTCString()}var ab=ac.path?"; path="+(ac.path):"";var X=ac.domain?"; domain="+(ac.domain):"";var R=ac.secure?"; secure":"";d.cookie=[S,"=",encodeURIComponent(Z),V,ab,X,R].join("")}else{var U=null;if(d.cookie&&d.cookie!=""){var aa=d.cookie.split(";");for(var Y=0;Y<aa.length;Y++){var T=a(aa[Y]);if(T.substring(0,S.length+1)==(S+"=")){U=decodeURIComponent(T.substring(S.length+1));break}}}return U}}var O=true;function i(W,X){if(!O){return}var V=new Date(),T=["[",V.getHours(),":",V.getMinutes(),":",V.getSeconds(),"-",V.getMilliseconds(),"]"].join(""),U=T+X+g.encode(W);I.console&&I.console.log(T,X,W);var S=d.getElementById("webim-log")||d.body;I.air&&I.air.trace(U);if(S){var R=d.createElement("P");R.innerHTML=U;S.appendChild(R)}}i.enable=function(){O=true};i.disable=function(){O=false};function e(T,S){var R=this;R.options=k({},e.defaults,S);this._init(T,S)}k(e.prototype,t,{_init:function(){var R=this;R.data={user:{}};R.status=new e.status();R.setting=new e.setting();R.buddy=new e.buddy();R.room=new e.room();R.history=new e.history();R.notification=new e.notification();R.connection=new B(null,{jsonp:true});R._initEvents()},ready:function(){var R=this;R._unloadFun=I.onbeforeunload;I.onbeforeunload=function(){R.refresh()};R.trigger("ready")},go:function(){var S=this,V=S.data,X=S.history,T=S.buddy,W=S.room;S.connection.connect(V.connection);X.option("userInfo",V.user);X.init(V.histories);T.handle(V.buddies);T.online(V.buddy_online_ids,true);var R=S.setting.get("block_list"),U=V.rooms;v(R)&&U&&K(R,function(aa,Z){U[Z]&&(U[Z].blocked=true)});W.handle(U);W.options.ticket=V.connection.ticket;var Y=V.new_messages;if(Y&&Y.length){S.trigger("message",[Y])}S.trigger("go",[V])},stop:function(S){var R=this;I.onbeforeunload=R._unloadFun;R.data.user.presence="offline";R.buddy.clear();R.trigger("stop",S)},autoOnline:function(){return !this.status.get("o")},_initEvents:function(){var T=this,R=T.status,U=T.setting,V=T.history,S=T.connection;S.bind("connect",function(X,W){}).bind("data",function(W){T.handle(W)}).bind("error",function(W){T.stop("connect error")}).bind("close",function(W){T.stop("disconnect")})},handle:function(S){var R=this;S.messages&&S.messages.length&&R.trigger("message",[S.messages]);S.presences&&S.presences.length&&R.trigger("presence",[S.presences]);S.statuses&&S.statuses.length&&R.trigger("status",[S.statuses])},sendMsg:function(S){var R=this;S.ticket=R.data.connection.ticket;A({type:"post",url:R.options.urls.message,type:"post",cache:false,data:S})},sendStatus:function(S){var R=this;S.ticket=R.data.connection.ticket;A({type:"post",url:R.options.urls.status,type:"post",cache:false,data:S})},setStranger:function(R){this.stranger_ids=C(R)},stranger_ids:[],online:function(){var S=this,R=S.status,T=[],U=R.get("tabs"),W=R.get("tabIds");R.set("o",false);S.ready();W&&W.length&&U&&K(U,function(Y,X){X.t=="buddy"&&T.push(Y)});var V=c();A({type:"post",dataType:"json",data:{buddy_ids:T.join(","),stranger_ids:S.stranger_ids.join(","),room_ids:V},url:S.options.urls.online,success:function(X){if(!X||!X.user||!X.connection){S.stop("online error")}else{X.user=k(S.data.user,X.user);S.data=X;S.go()}},error:function(X){S.stop("online error")}})},offline:function(){var R=this,S=R.data;R.status.set("o",true);R.connection.close();R.stop("offline");A({type:"post",url:R.options.urls.offline,type:"post",cache:false,data:{status:"offline",ticket:S.connection.ticket}})},refresh:function(){var R=this,S=R.data;if(!S||!S.connection||!S.connection.ticket){return}A({type:"post",url:R.options.urls.refresh,type:"post",cache:false,data:{ticket:S.connection.ticket}})}});function C(R){return R&&R.split?R.split(","):(v(R)?R:(parseInt(R)?[parseInt(R)]:[]))}function b(S,U,T){function R(X,W){var V=this;V.data=X;V.options=k({},R.defaults,W);q(V._init)&&V._init()}R.defaults=U;k(R.prototype,t,T);e[S]=R}I.webim=e;k(e,{version:"1.0.0pre",defaults:{},log:i,idsArray:C,now:J,isFunction:q,isArray:v,isObject:E,trim:a,makeArray:p,extend:k,each:K,inArray:L,grep:N,map:w,JSON:g,ajax:A,model:b,objectExtend:t});b("setting",{url:"/webim/setting",data:{play_sound:true,buddy_sticky:true,minimize_layout:false,msg_auto_pop:true}},{_init:function(){var R=this;R.data=k({},R.options.data,R.data)},get:function(R){return this.data[R]},set:function(V,X){var T=this,U=V;if(!V){return}if(typeof V=="string"){U={};U[V]=X}var S=T.data,R=Q(S,U);if(R){K(R,function(Y,Z){T.trigger("update",[Y,Z])});var W=k({},S,U);T.data=W;A({type:"post",url:T.options.url,dataType:"json",cache:false,data:{data:g.encode(W)}})}}});b("status",{key:"_webim"},{_init:function(){var R=this,S=R.data;if(!S){var T=x(R.options.key);R.data=T?g.decode(T):{}}else{R._save(S)}},set:function(U,W){var T=U,S=this;if(typeof U=="string"){T={};T[U]=W}var R=S.data;if(Q(R,T)){var V=k({},R,T);S._save(V)}},get:function(R){return this.data[R]},clear:function(){this._save({})},_save:function(R){this.data=R;x(this.options.key,g.encode(R),{path:"/",domain:d.domain})}});b("buddy",{url:"/webim/buddy"},{_init:function(){var R=this;R.data=R.data||[];R.dataHash={};R._cacheData={};R.handle(R.data)},clear:function(){var R=this;R.data=[];R.dataHash={};R._cacheData={}},count:function(W){var V=k({},this.dataHash,this._cacheData),U=0,T;for(var S in V){if(E(W)){T=true;for(var R in W){if(W[R]!=V[S][R]){T=false}}if(T){U++}}else{U++}}return U},get:function(R){return this.dataHash[R]},online:function(S,R){this.changeStatus(S,"online",true,R)},offline:function(R){this.changeStatus(R,"offline",false)},loadDelay:function(){var S=this,R=S._cacheData,T=[];for(var U in R){T.push(U)}S.load(T)},update:function(R){this.load(R)},changeStatus:function(R,aa,Y,U){R=C(R);var V=R.length;if(V){var ad=this,S=ad._cacheData,X=ad.dataHash,ab=[],T,Z=[],ac;for(var W=0;W<V;W++){T=R[W];if(X[T]){ab.push({id:T,presence:aa})}else{ac={id:T,presence:aa};if(!S[T]||S[T].presence!=aa){Z.push(ac)}if(Y){S[T]=ac}else{if(S[T]){delete S[T]}}}}ad.handle(ab);if(Y&&!U){ad.loadDelay()}else{if(Z.length){if(Y){ad.trigger(aa+"Delay",[Z])}else{ad.trigger(aa,[Z])}}}}},_loadSuccess:function(W){var T=this.self||this,S=T._cacheData,R=W.length,V,X;for(var U in W){V=W[U];X=V.id;if(S[X]){k(V,S[X]);delete S[X]}}T.handle(W)},load:function(T){T=C(T);if(T.length){var R=this,S=R.options;A({url:S.url,cache:false,dataType:"json",data:{ids:T.join(",")},context:R,success:R._loadSuccess})}},handle:function(S){var ab=this,V=ab.data,W=ab.dataHash,T={};S=S||[];var R=S.length,Z,X,aa;for(var U in S){Z=S[U],id=Z.id;if(id){if(!W[id]){W[id]={};V.push(W[id])}aa=Q(W[id],Z);if(aa){X=aa.presence||"update";T[X]=T[X]||[];k(W[id],aa);T[X].push(W[id])}}}for(var Y in T){ab.trigger(Y,[T[Y]])}}});(function(){b("room",{urls:{join:"/webim/join.php",leave:"/webim/leave.php",member:"/webim/members.php"}},{_init:function(){var R=this;R.data=R.data||[];R.dataHash={}},get:function(R){return this.dataHash[R]},block:function(U){var R=this,T=R.dataHash[U];if(T&&!T.blocked){T.blocked=true;var S=[];K(R.dataHash,function(W,V){if(V.blocked){S.push(V.id)}});R.trigger("block",[U,S])}},unblock:function(U){var R=this,T=R.dataHash[U];if(T&&T.blocked){T.blocked=false;var S=[];K(R.dataHash,function(W,V){if(V.blocked){S.push(V.id)}});R.trigger("unblock",[U,S])}},handle:function(V){var S=this,U=S.data,T=S.dataHash,R={};K(V,function(X,W){var Y=W.id;if(Y){W.members=W.members||[];W.count=W.count||0;W.all_count=W.all_count||0;if(!T[Y]){T[Y]=W;U.push(W)}else{k(T[Y],W)}S.trigger("join",[T[Y]])}})},addMember:function(U,W){var S=this;if(v(W)){K(W,function(Z,Y){S.addMember(U,Y)});return}var V=S.dataHash[U];if(V){var R=V.members,X;for(var T=R.length;T--;T){if(R[T].id==W.id){X=R[T]}}if(!X){W.name=W.nick||W.name;R.push(W);V.members.length;S.trigger("addMember",[U,W])}}},removeMember:function(U,T){var V=this.dataHash[U];if(V){var R=V.members,W;for(var S=R.length;S--;S){if(R[S].id==T){W=R[S];R.splice(S,1);V.count--}}W&&self.trigger("removeMember",[U,W])}},initMember:function(S){var R=this.dataHash[S];if(R&&!R.initMember){R.initMember=true;this.loadMember(S)}},loadMember:function(T){var R=this,S=R.options;A({cache:false,url:S.urls.member,dataType:"json",data:{ticket:S.ticket,id:T},success:function(U){K(U,function(W,V){R.addMember(W,V)})}})},join:function(U,S){var R=this,T=R.options;A({cache:false,url:T.urls.join,dataType:"json",data:{ticket:T.ticket,id:U,nick:S.name},success:function(V){R.initMember(U);R.handle([V])}})},leave:function(V,S){var R=this,T=R.options,U=R.dataHash[V];if(U){U.initMember=false;A({cache:false,url:T.urls.leave,data:{ticket:T.ticket,id:V,nick:S.name}});R.trigger("leave",[U])}},clear:function(){}})})();b("notification",{url:"webim/notifications"},{grep:function(R,S){return R&&R.text},handle:function(S){var R=this;S=N(p(S),R.grep);if(S.length){R.trigger("data",[S])}},load:function(){var R=this,S=R.options;A({url:S.url,cache:false,dataType:"json",context:R,success:R.handle})}});b("history",{urls:{load:"",clear:""}},{_init:function(){this.data=this.data||{}},get:function(R){return this.data[R]},handle:function(V){var ab=this,X=ab.data,S={};V=p(V);var U=V.length,aa,T,Y=ab.options.userInfo.id;if(!U){return}for(var W=0;W<U;W++){aa=V[W];T=aa.to==Y?aa.from:aa.to;if(T){S[T]=S[T]||[];S[T].push(aa)}}var R=[];for(var Z in S){var aa=S[Z];if(X[Z]){X[Z]=X[Z].concat(aa);ab._triggerMsg(Z,aa)}else{R.push(Z)}}ab.load(R)},_triggerMsg:function(S,R){this.trigger("data",[S,R])},clear:function(V){V=C(V);var S=this,R=V.length,T=S.options,W;if(R){for(var U=0;U<R;U++){W=V[U];S.data[W]=[];S.trigger("clear",[W])}A({url:T.urls.clear,cache:false,dataType:"json",data:{ids:V.join(",")}})}},init:function(U){var S=this.self||this,R;for(var T in U){R=U[T];S.data[T]=R;S._triggerMsg(T,R)}},load:function(U){U=C(U);if(U.length){var R=this,S=R.options;for(var T=0;T<U.length;T++){R.data[U[T]]=[]}A({url:S.urls.load,cache:false,dataType:"json",data:{ids:U.join(",")},context:R,success:R.init})}}});b("hotpost",{url:"webim/hotpost"},{grep:function(R,S){return R&&R.text},handle:function(S){var R=this;S=N(p(S),R.grep);if(S.length){R.trigger("data",[S])}},load:function(){var R=this,S=R.options;A({url:S.url,cache:false,dataType:"json",context:R,success:R.handle})}})})(window,document);